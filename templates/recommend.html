<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Learnify.AI ‚Äì Recommendations for {{ topic }}</title>
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
/* ROOT THEME */
:root{
  --bg1:#0b132b;
  --bg2:#1c2541;
  --panel:#0f1629;
  --panel2:#162038;
  --accent:#00b4d8;
  --accent2:#90e0ef;
  --text:#eaf7fb;
  --muted:rgba(255,255,255,0.7);
}

/* GLOBAL */
body{
  margin:0;padding:0;color:#fff;
  background:linear-gradient(135deg,var(--bg1),var(--bg2));
  font-family:"Poppins",sans-serif;
}

.navbar{
  display:flex;justify-content:space-between;align-items:center;
  padding:16px 6%;background:rgba(0,0,0,0.3);backdrop-filter:blur(10px);
  position:sticky;top:0;z-index:20;
}
.brand{color:var(--accent2);font-size:1.4rem;font-weight:700;text-decoration:none;}
.nav-links{list-style:none;display:flex;gap:14px;}
.nav-links a{color:#fff;text-decoration:none;font-weight:500;}
.nav-links a:hover{color:var(--accent);}

.topic-pill{
  padding:6px 12px;border-radius:999px;
  background:rgba(255,255,255,0.1);
}

/* CONTAINER */
.container{max-width:1180px;margin:0 auto;padding:20px 6%;}

/* TOP BANNER */
.topic-banner{
  background:rgba(255,255,255,0.06);border-radius:16px;padding:24px;
  display:flex;justify-content:space-between;gap:20px;box-shadow:0 12px 28px rgba(0,0,0,0.45);
}
.topic-title h1{margin:0;color:var(--accent2);}
.topic-title p{margin-top:4px;color:var(--muted);}

.page-cta button{
  padding:10px 16px;border:none;border-radius:999px;font-weight:600;
  cursor:pointer;margin-top:6px;
}
.btn-primary{
  background:linear-gradient(90deg,#00b4d8,#0077b6);color:white;
}
.btn-ghost{
  background:rgba(255,255,255,0.06);color:var(--muted);
  border:1px solid rgba(255,255,255,0.1);
}

/* LAYOUT */
.layout{
  margin-top:24px;display:grid;grid-template-columns:260px 1fr;gap:20px;
}
.side-card{
  background:rgba(255,255,255,0.08);padding:18px;border-radius:14px;
}
.filter-chip{
  background:rgba(255,255,255,0.08);
  padding:6px 12px;border-radius:999px;cursor:pointer;
  display:inline-block;margin:4px;font-size:.9rem;
}
.active-filter{background:var(--accent);color:#000!important;}

.main-column{display:flex;flex-direction:column;gap:28px;}

.section-head{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;}

/* RESOURCE CARDS */
.res-grid{
  display:grid;gap:18px;
  grid-template-columns:repeat(auto-fit,minmax(270px,1fr));
}

.res-card{
  background:var(--panel);padding:18px;border-radius:16px;
  display:flex;gap:16px;position:relative;
  border:1px solid rgba(255,255,255,0.05);
  box-shadow:0 4px 18px rgba(0,0,0,0.4);
}
.res-thumb img{
  width:60px;height:60px;border-radius:12px;background:var(--panel2);
  object-fit:contain;padding:6px;
}
.res-title{font-size:18px;margin:0;}
.res-desc{color:#b8c3e3;font-size:14px;margin:6px 0;}

.show-more-btn{
  background:none;border:none;color:var(--accent2);
  margin-top:4px;cursor:pointer;
}

.badge{
  background:#15223d;padding:4px 10px;border-radius:8px;font-size:12px;
  border:1px solid #233558;
  margin-right:6px;
}
.res-premium-link{
  margin-top:8px;display:inline-flex;color:var(--accent2);font-weight:600;text-decoration:none;
}
.category-icon{
  position:absolute;left:14px;top:12px;font-size:22px;
}

/* VIDEO GRID */
.video-grid{
  display:grid;gap:16px;
  grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
}
.video-card{
  display:block;background:rgba(255,255,255,0.08);
  border:1px solid rgba(255,255,255,0.08);
  border-radius:14px;overflow:hidden;text-decoration:none;color:white;
  transition:0.3s;
}
.video-card:hover{transform:translateY(-4px);}
.video-card img{width:100%;height:160px;object-fit:cover;}
.video-body{padding:10px;}
</style>
</head>

<body>

<!-- NAVBAR -->
<nav class="navbar">
  <a class="brand" href="/">Learnify.AI</a>

  <ul class="nav-links">
    <li><a href="/">Home</a></li>
    <li><a href="/dashboard">Dashboard</a></li>
    <li><a href="/about">About</a></li>
  </ul>

  <div class="topic-pill"><i class="fa-solid fa-book"></i> {{ topic }}</div>
</nav>

<div class="container">

<!-- TOP BANNER -->
<section class="topic-banner">
  <div class="topic-title">
    <h1>{{ topic }} ‚Äì Recommendations</h1>
    <p>Your Query ‚Üí <b>{{ query }}</b></p>

    <div style="margin-top:10px;padding:6px 12px;border-radius:999px;background:rgba(255,255,255,0.08);display:inline-block;">
      {% if mood == "excited" %} üòÄ Excited  
      {% elif mood=="confused" %} üòï Confused  
      {% else %} üôÇ Neutral  
      {% endif %}
      (Sentiment: {{ sentiment }})
    </div>
  </div>

  <div class="page-cta">
    <button class="btn-primary" onclick="openRoadmap()">View Roadmap</button>
    <button class="btn-ghost" onclick="scrollToVideos()">Jump to Videos</button>
  </div>
</section>

<!-- MAIN -->
<section class="layout">

  <!-- LEFT SIDEBAR -->
  <aside class="side-card">
    <h3>Quick Filters</h3>

    <span class="filter-chip quick-filter" data-level="Basics">Basics</span>
    <span class="filter-chip quick-filter" data-level="Beginner">Beginner</span>
    <span class="filter-chip quick-filter" data-level="Projects">Projects</span>
    <span class="filter-chip quick-filter" data-level="Advanced">Advanced</span>

    <h3 style="margin-top:20px;">Only Roadmap?</h3>
    <button class="btn-ghost" style="width:100%;" onclick="openRoadmap()">Open Roadmap</button>
  </aside>

  <!-- RIGHT -->
  <div class="main-column">

    <!-- RESOURCES -->
    <section>
      <div class="section-head">
        <h2>Recommended Online Resources</h2>
        <span>{{ online_resources|length }} found</span>
      </div>

      <div class="res-grid">

      {% for r in online_resources %}
      <article class="res-card"
        data-level="{{ r.level }}"
        data-category="{{ r.category }}"
        data-platform="{{ r.platform }}">

        <div class="category-icon">
          {% if r.category=="AI" %} ü§ñ
          {% elif r.category=="Web" %} üåê
          {% elif r.category=="Cloud" %} ‚òÅÔ∏è
          {% elif r.category=="DSA" %} üìö
          {% elif r.category=="App Dev" %} üì±
          {% else %} üìò {% endif %}
        </div>

        <div class="res-thumb">
          {% if r.image %}
            <img src="{{ r.image }}">
          {% else %}
            <i class="fa-solid fa-globe"></i>
          {% endif %}
        </div>

        <div>
          <h3 class="res-title">{{ r.title }}</h3>

          <p class="res-desc short">{{ r.description }}</p>
          <p class="res-desc full" style="display:none;">{{ r.full_description }}</p>

          <button class="show-more-btn">Show more</button>

          <div class="res-meta">
            <span class="badge">{{ r.type if r.type else "Resource" }}</span>
            <span class="badge">{{ r.level }}</span>
            <span class="badge">{{ r.platform }}</span>
          </div>

          <a href="{{ r.url }}" target="_blank" class="res-premium-link">
            Open Resource <i class="fa-solid fa-arrow-up-right-from-square"></i>
          </a>
        </div>

      </article>
      {% endfor %}

      </div>
    </section>

    <!-- VIDEOS -->
    <section id="videos">
      <div class="section-head">
        <h2>Handpicked YouTube Tutorials</h2>
        <span>{{ videos|length }} videos</span>
      </div>

      <div class="video-grid">
        {% for v in videos %}
        <a class="video-card"
           href="{{ v.url }}"
           target="_blank"
           data-level="{{ v.level }}"
           data-category="{{ v.category }}"
           data-platform="YouTube">

          <img src="{{ v.thumbnail }}">
          <div class="video-body">{{ v.title }}</div>

        </a>
        {% endfor %}
      </div>
    </section>

  </div>
</section>
</div>

<!-- HIDDEN FORMS -->
<form id="roadmapForm" action="/recommend" method="POST" style="display:none;">
  <input type="hidden" id="roadmapInput" name="user_input">
</form>

<!-- JAVASCRIPT -->
<script>
function openRoadmap(){
  document.getElementById("roadmapInput").value = "{{ topic }} roadmap";
  document.getElementById("roadmapForm").submit();
}
function scrollToVideos(){
  document.getElementById("videos").scrollIntoView({behavior:"smooth"});
}

/* NORMALIZE */
function normalize(t){return t?t.trim().toLowerCase():"";}

/* SHOW MORE */
document.querySelectorAll(".show-more-btn").forEach(btn=>{
  btn.onclick=()=>{
    const card=btn.parentElement;
    card.querySelector(".short").style.display="none";
    card.querySelector(".full").style.display="block";
    btn.remove();
  };
});

/* QUICK FILTERS */
document.querySelectorAll(".quick-filter").forEach(btn=>{
  btn.addEventListener("click",()=>{
    document.querySelectorAll(".quick-filter").forEach(x=>x.classList.remove("active-filter"));
    btn.classList.add("active-filter");

    const selected=normalize(btn.dataset.level);
    const map={
      "basics":["basics","beginner"],
      "beginner":["basics","beginner"],
      "projects":["projects"],
      "advanced":["advanced"]
    };
    const allowed=map[selected]||[selected];

    /* Resource Filter */
    document.querySelectorAll(".res-card").forEach(card=>{
      const lv=normalize(card.dataset.level||"");
      card.style.display = allowed.includes(lv) ? "flex":"none";
    });

    /* Video Filter */
    document.querySelectorAll(".video-card").forEach(v=>{
      const lv=normalize(v.dataset.level||"");
      v.style.display = allowed.includes(lv) ? "block":"none";
    });
  });
});
</script>

</body>
</html>
